(()=>{"use strict";const e=window.wp.element,t=window.React;function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},n.apply(this,arguments)}const l=window.wp.components,a=window.wp.i18n,o=(0,e.createContext)(),c={heading:{text:(0,a.__)("The quick brown fox jumps over the lazy dog.","create-block-theme"),size:40,lineHeight:1.1,margin:"0.5em",component:"h2"},sentence:{text:(0,a.__)("Incredible as it may seem, I believe that the Aleph of Garay Street was a false Aleph.","create-block-theme"),size:24,lineHeight:1.3,margin:"0.5em",component:"p"},paragraph:{text:(0,a.__)("First a glass of pseudo-cognac, he ordered, and then down you dive into the cellar. Let me warn you, you'll have to lie flat on your back. Total darkness, total immobility, and a certain ocular adjustment will also be necessary. From the floor, you must focus your eyes on the nineteenth step. Once I leave you, I'll lower the trapdoor and you'll be quite alone. You needn't fear the rodents very much though I know you will. In a minute or two, you'll see the Aleph, the microcosm of the alchemists and Kabbalists, our true proverbial friend, the multum in parvo!","create-block-theme"),size:16,lineHeight:1.5,margin:"0.5em",component:"p"}};function r(t){let{children:n}=t;const[l,a]=(0,e.useState)(localStorage.getItem("cbt_default-demo-type")||"sentence"),[r,m]=(0,e.useState)(localStorage.getItem("cbt_default-demo-text")||c[l].text),[i,s]=(0,e.useState)(parseInt(localStorage.getItem("cbt_default-demo-font-size"))||c[l].size),d=e=>{m(e),localStorage.setItem("cbt_default-demo-text",e)},u=e=>{s(e),localStorage.setItem("cbt_default-demo-font-size",e)},f=e=>{d(c[e||l].text),u(c[e||l].size)};return(0,e.createElement)(o.Provider,{value:{demoText:r,handleDemoTextChange:d,resetDefaults:f,demoType:l,handleDemoTypeChange:e=>{a(e),localStorage.setItem("cbt_default-demo-type",e),f(e)},demoFontSize:i,handleDemoFontSizeChange:u}},n)}const m=function(t){let{style:n}=t;const{demoText:l,demoType:a,demoFontSize:r}=(0,e.useContext)(o),m=c[a].component,i={...n,fontSize:`${r}px`,lineHeight:c[a].lineHeight,margin:c[a].margin};return(0,e.createElement)("div",null,(0,e.createElement)(m,{style:i},l))},{__}=wp.i18n;function i(t){let{fontFamily:n,fontWeight:a,fontStyle:c,deleteFontFace:r,shouldBeRemoved:i}=t;const{demoText:s,handleDemoTextChange:d,resetDefaults:u}=(0,e.useContext)(o),f={fontFamily:n,fontStyle:c,fontWeight:a?String(a).split(" ")[0]:"normal"};return i?null:(0,e.createElement)("tr",{className:"font-face"},(0,e.createElement)("td",null,c),(0,e.createElement)("td",null,a),(0,e.createElement)("td",{className:"demo-cell"},(0,e.createElement)(m,{style:f})),r&&(0,e.createElement)("td",null,(0,e.createElement)(l.Button,{variant:"tertiary",isDestructive:!0,onClick:r},__("Remove","create-block-theme"))))}i.defaultProps={fontWeight:"normal",fontStyle:"normal"};const s=i,{__:d}=wp.i18n,u=function(a){let{fontFamily:o,fontFamilyIndex:c,deleteFontFamily:r,deleteFontFace:m}=a;const[i,u]=(0,t.useState)(!0),f=!!o.fontFace&&!!o.fontFace.length;return o.shouldBeRemoved?null:(0,e.createElement)("table",{className:"wp-list-table widefat table-view-list"},(0,e.createElement)("thead",null,(0,e.createElement)("tr",null,(0,e.createElement)("td",{className:"font-family-head"},(0,e.createElement)("div",null,(0,e.createElement)("strong",null,o.name||o.fontFamily)),(0,e.createElement)("div",null,(0,e.createElement)(l.Button,{variant:"tertiary",isDestructive:!0,onClick:e=>{e.stopPropagation(),r(c)}},d("Remove Font Family","create-block-theme")),(0,e.createElement)(l.Button,{onClick:()=>{u(!i)}},(0,e.createElement)(l.Icon,{icon:i?"arrow-up-alt2":"arrow-down-alt2"})))))),(0,e.createElement)("tbody",{className:"font-family-contents"},(0,e.createElement)("tr",{className:"container"},(0,e.createElement)("td",{className:" slide "+(i?"open":"close")},(0,e.createElement)("table",{className:"wp-list-table widefat striped table-view-list"},(0,e.createElement)("thead",null,(0,e.createElement)("tr",null,(0,e.createElement)("td",null,d("Style","create-block-theme")),(0,e.createElement)("td",null,d("Weight","create-block-theme")),(0,e.createElement)("td",{className:"preview-head"},d("Preview","create-block-theme")),f&&(0,e.createElement)("td",null))),(0,e.createElement)("tbody",null,f&&o.fontFace.map(((t,l)=>(0,e.createElement)(s,n({},t,{fontFamilyIndex:c,fontFaceIndex:l,key:`fontface${l}`,deleteFontFace:()=>m(c,l)})))),!f&&o.fontFamily&&(0,e.createElement)(s,o)))))))},f=window.wp.primitives,h=(0,e.createElement)(f.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(f.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})),p=function(){const{demoText:t,handleDemoTextChange:n,demoType:c,handleDemoTypeChange:r,demoFontSize:m,handleDemoFontSizeChange:i,resetDefaults:s}=(0,e.useContext)(o);return(0,e.createElement)("div",{className:"demo-text-input"},(0,e.createElement)("div",{className:"container"},(0,e.createElement)(l.SelectControl,{label:(0,a.__)("Preview type","create-block-theme"),onChange:r,value:c},(0,e.createElement)("option",{value:"heading"},(0,a.__)("Heading","create-block-theme")),(0,e.createElement)("option",{value:"sentence"},(0,a.__)("Sentence","create-block-theme")),(0,e.createElement)("option",{value:"paragraph"},(0,a.__)("Paragraph","create-block-theme"))),(0,e.createElement)(l.__experimentalInputControl,{label:"Demo text",value:t,onChange:n}),(0,e.createElement)("div",null,(0,e.createElement)(l.RangeControl,{label:(0,a.__)("Font size (px)","create-block-theme"),value:m,onChange:i,min:8,max:140,withInputField:!0})),(0,e.createElement)("div",null,(0,e.createElement)(l.Button,{variant:"secondary",icon:h,onClick:()=>{s("sentence"),r("sentence")}},(0,a.__)("Reset","create-block-theme")))))},{__:y}=wp.i18n,E=function(){const n=document.querySelector("#theme-fonts-json"),a=document.querySelector("#manage-fonts-form"),o=n.innerHTML,c=JSON.parse(o),[r,m]=(0,t.useState)(c),[i,s]=(0,t.useState)({fontFamilyIndex:void 0,fontFaceIndex:void 0}),[d,f]=(0,t.useState)(!1),[h,E]=(0,t.useState)(!1);(0,t.useEffect)((()=>{void 0===i.fontFamilyIndex&&void 0===i.fontFaceIndex||a.submit()}),[r]);const g=()=>{E(!h)};function v(e,t){s({fontFamilyIndex:e,fontFaceIndex:t},f(!0))}const b=r[i.fontFamilyIndex],w=r[i.fontFamilyIndex]?.fontFace?.[i.fontFaceIndex];return(0,e.createElement)(e.Fragment,null,h&&(0,e.createElement)(l.Modal,{title:(0,e.createElement)(e.Fragment,null,(0,e.createElement)(l.Icon,{icon:"info"})," ",y("Info","create-block-theme")),onRequestClose:g},(0,e.createElement)("p",null,y("This is a list of your font families listed in the theme.json file of your theme.","create-block-theme")),(0,e.createElement)("p",null,y("If your theme.json makes reference to fonts providers other than local they may not be displayed correctly.","create-block-theme"))),(0,e.createElement)("p",{className:"help"},y("These are the fonts currently embedded in your theme ","create-block-theme"),(0,e.createElement)(l.Button,{onClick:g,style:{padding:"0",height:"1rem"}},(0,e.createElement)(l.Icon,{icon:"info"}))),(0,e.createElement)("input",{type:"hidden",name:"new-theme-fonts-json",value:JSON.stringify(r)}),(0,e.createElement)(l.__experimentalConfirmDialog,{isOpen:d,onConfirm:function(){f(!1),void 0!==i.fontFamilyIndex&&void 0!==i.fontFaceIndex?function(){const{fontFamilyIndex:e,fontFaceIndex:t}=i,n=r.reduce(((n,l,a)=>{const{fontFace:o=[],...c}=l;return e===a&&1===o.filter((e=>!e.shouldBeRemoved)).length&&(c.shouldBeRemoved=!0),c.fontFace=o.map(((n,l)=>e==a&&t===l?{...n,shouldBeRemoved:!0}:n)),[...n,c]}),[]);m(n)}(i.fontFamilyIndex,i.fontFaceIndex):function(e){const t=r.map(((t,n)=>n===e?{...t,shouldBeRemoved:!0}:t));m(t)}(i.fontFamilyIndex)},onCancel:function(){s({}),f(!1)}},void 0!==i?.fontFamilyIndex&&void 0!==i?.fontFaceIndex?(0,e.createElement)("h3",null,y(`Are you sure you want to delete "${w?.fontStyle} - ${w?.fontWeight}"  variant of "${b?.fontFamily}" from your theme?`,"create-block-theme")):(0,e.createElement)("h3",null,y(`Are you sure you want to delete "${b?.fontFamily}" from your theme?`,"create-block-theme")),(0,e.createElement)("p",null,y("This action will delete the font definition and the font file assets from your theme.","create-block-theme"))),(0,e.createElement)(p,null),(0,e.createElement)("div",{className:"font-families"},r.map(((t,n)=>(0,e.createElement)(u,{fontFamily:t,fontFamilyIndex:n,key:`fontfamily${n}`,deleteFontFamily:v,deleteFontFace:v})))))},g=window.wp.data,v=window.wp.coreData,b=function(t){let{font:n,variant:l,isSelected:a,handleToggle:o}=t;const c=l.includes("italic")?"italic":"normal",r="regular"===l||"italic"===l?"400":l.replace("italic",""),i=n.files[l].replace("http://","https://"),s={fontFamily:n.family,fontStyle:c,fontWeight:r};return(0,e.useEffect)((()=>{new FontFace(n.family,`url( ${i} )`,{style:c,weight:r}).load().then((function(e){document.fonts.add(e)})).catch((function(e){console.error(e)}))}),[n,l]),(0,e.createElement)("tr",null,(0,e.createElement)("td",{className:""},(0,e.createElement)("input",{type:"checkbox",name:"google-font-variant",value:l,checked:a,onClick:o})),(0,e.createElement)("td",{className:""},r),(0,e.createElement)("td",{className:""},c),(0,e.createElement)("td",{className:"demo-cell"},(0,e.createElement)(m,{style:s})))};function w(e){return e.includes("italic")?"italic":"normal"}function F(e){return"regular"===e||"italic"===e?"400":e.replace("italic","")}const S=JSON.stringify({}),_=function(){const[t,n]=(0,e.useState)({}),[o,c]=(0,e.useState)(null),[r,m]=(0,e.useState)([]),[i,s]=(0,e.useState)(S),d=document.querySelector("#nonce").value;(0,e.useEffect)((()=>{(async()=>{const e=await fetch(createBlockTheme.googleFontsDataUrl),t=await e.json();n(t)})()}),[]),(0,e.useEffect)((()=>{m([]),s(S)}),[o]),(0,e.useEffect)((()=>{if(o&&r.length){const e=r.map((e=>{return{style:w(e),weight:F(e),src:(t=o.files[e],t.replace("http://","https://"))};var t})),t={family:o.family,faces:e};s(JSON.stringify(t))}else s(S)}),[r]);const u=(0,g.useSelect)((e=>e(v.store).getCurrentTheme()),null);return(0,e.createElement)("div",{className:"wrap google-fonts-page"},(0,e.createElement)("h1",{className:"wp-heading-inline"},(0,a.__)("Add Google fonts to your theme","create-block-theme")),(0,e.createElement)("h3",null,(0,a.__)("Add Google fonts assets and font face definitions to your currently active theme","create-block-theme")," (",u?.name.rendered,")"),!t?.items&&(0,e.createElement)("p",null,(0,e.createElement)(l.Spinner,null),(0,e.createElement)("span",null,(0,a.__)("Loading Google fonts data...","create-block-theme"))),t?.items&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"select-font"},(0,e.createElement)(l.SelectControl,{label:(0,a.__)("Select Font","create-block-theme"),name:"google-font",onChange:e=>{c(t.items[e])}},(0,e.createElement)("option",{value:null},(0,a.__)("Select a font...","create-block-theme")),t.items.map(((t,n)=>(0,e.createElement)("option",{value:n},t.family))))),(0,e.createElement)(p,null),o&&(0,e.createElement)("p",null,(0,a.__)("Select the font variants you want to include:","create-block-theme")),o&&(0,e.createElement)("table",{className:"wp-list-table widefat striped table-view-list",id:"google-fonts-table"},(0,e.createElement)("thead",null,(0,e.createElement)("tr",null,(0,e.createElement)("td",{className:""},(0,e.createElement)("input",{type:"checkbox",onClick:()=>{r.length?m([]):m(o.variants)},checked:r.length===o?.variants.length})),(0,e.createElement)("td",{className:""},(0,a.__)("Weight","create-block-theme")),(0,e.createElement)("td",{className:""},(0,a.__)("Style","create-block-theme")),(0,e.createElement)("td",{className:""},(0,a.__)("Preview","create-block-theme")))),(0,e.createElement)("tbody",null,o.variants.map(((t,n)=>(0,e.createElement)(b,{font:o,variant:t,key:`font-variant-${n}`,isSelected:r.includes(t),handleToggle:()=>(e=>{r.includes(e)?m(r.filter((t=>t!==e))):m([...r,e])})(t)}))))),(0,e.createElement)("form",{enctype:"multipart/form-data",action:"",method:"POST"},(0,e.createElement)("input",{type:"hidden",name:"selection-data",value:i}),(0,e.createElement)("input",{type:"submit",value:(0,a.__)("Add google fonts to your theme","create-block-theme"),className:"button button-primary",disabled:0===r.length}),(0,e.createElement)("input",{type:"hidden",name:"nonce",value:d}))))};function k(){let t=null;switch(new URLSearchParams(document.location.search).get("page")){case"manage-fonts":t=E;break;case"add-google-font-to-theme-json":t=_;break;default:t=()=>(0,e.createElement)("h1",null,"This page is not implemented yet.")}return(0,e.createElement)(r,null,(0,e.createElement)(t,null))}window.addEventListener("load",(function(){(0,e.render)((0,e.createElement)(k,null),document.querySelector("#fonts-app"))}),!1)})();